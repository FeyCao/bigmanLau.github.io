window.__require=function e(t,o,i){function r(a,c){if(!o[a]){if(!t[a]){var l=a.split("/");if(l=l[l.length-1],!t[l]){var p="function"==typeof __require&&__require;if(!c&&p)return p(l,!0);if(n)return n(l,!0);throw new Error("Cannot find module '"+a+"'")}}var s=o[a]={exports:{}};t[a][0].call(s.exports,function(e){return r(t[a][1][e]||e)},s,s.exports,e,t,o,i)}return o[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<i.length;a++)r(i[a]);return r}({HelloWorld:[function(e,t,o){"use strict";cc._RF.push(t,"280c3rsZJJKnZ9RqbALVwtK","HelloWorld"),cc.Class({extends:cc.Component,properties:{label:{default:null,type:cc.Label},text:"Hello, World!"},onLoad:function(){this.label.string=this.text},update:function(e){}}),cc._RF.pop()},{}],bomb:[function(e,t,o){"use strict";cc._RF.push(t,"86a4c3Ag6RHBYLUG+jVClP1","bomb"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,n=(i.property,function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.onLoad=function(){cc.log("onLoad bomb"),this.getComponent(cc.Animation).play()},t.prototype.exploded=function(){this.node.parent.emit("exploded")},t=__decorate([r],t)}(cc.Component));o.default=n,cc._RF.pop()},{}],enermy:[function(e,t,o){"use strict";cc._RF.push(t,"72251/h3tBHYb0kbm0F/GkZ","enermy"),Object.defineProperty(o,"__esModule",{value:!0});var i,r=cc._decorator,n=r.ccclass;r.property;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT",e[e.UP=2]="UP",e[e.DOWN=3]="DOWN"})(i||(i={}));var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._tileX=0,t._tileY=0,t.x=0,t.y=0,t.count=0,t.dir=1,t}return __extends(t,e),t.prototype.onLoad=function(){},t.prototype.doMove=function(){var e=this._tileX,t=this._tileY;this.dir=Math.floor(4*Math.random()+1),1==this.dir&&e--,2==this.dir&&e++,3==this.dir&&t--,4==this.dir&&t++,this.move(e,t)},t.prototype.move=function(e,t){var o=cc.v2(e,t);if(this.mainLayer.getTileGIDAt(o))return!1;if(this.brickLayer.getTileGIDAt(o))return!1;this._tileX=e,this._tileY=t;var i=this.mainLayer.getPositionAt(o);this.node.setPosition(i)},t.prototype.update=function(e){this.count+e>60?(this.doMove(),this.count=0):this.count++},t=__decorate([n],t)}(cc.Component);o.default=a,cc._RF.pop()},{}],map:[function(e,t,o){"use strict";cc._RF.push(t,"f68c7T7cZdA5KYkIGC6YUOd","map"),Object.defineProperty(o,"__esModule",{value:!0});var i=e("./player"),r=e("./enermy"),n=cc._decorator,a=n.ccclass,c=n.property,l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.map=null,t.enermy=null,t.player=null,t.mainLayer=null,t.objectLayer=null,t.brickLayer=null,t}return __extends(t,e),t.prototype.onLoad=function(){var e=this;this.loadMap(),this.mainLayer.node.on("exploded",function(){e.brickLayer.getTileGIDAt(e.playerComponent.bombTile.x-1,e.playerComponent.bombTile.y)&&(cc.log("left"),e.brickLayer.setTileGIDAt(0,e.playerComponent.bombTile.x-1,e.playerComponent.bombTile.y)),e.brickLayer.getTileGIDAt(e.playerComponent.bombTile.x+1,e.playerComponent.bombTile.y)&&(cc.log("right"),e.brickLayer.setTileGIDAt(0,e.playerComponent.bombTile.x+1,e.playerComponent.bombTile.y)),e.brickLayer.getTileGIDAt(e.playerComponent.bombTile.x,e.playerComponent.bombTile.y-1)&&(cc.log("up"),e.brickLayer.setTileGIDAt(0,e.playerComponent.bombTile.x,e.playerComponent.bombTile.y-1)),e.brickLayer.getTileGIDAt(e.playerComponent.bombTile.x,e.playerComponent.bombTile.y+1)&&(cc.log("down"),e.brickLayer.setTileGIDAt(0,e.playerComponent.bombTile.x,e.playerComponent.bombTile.y+1)),e.mainLayer.node.removeChild(e.playerComponent.bomb),e.playerComponent.bomb=null},this)},t.prototype.loadMap=function(){var e=this;this.map.getObjectGroup("object").getObjects().forEach(function(t){0==t.type?e.playerGenarate(t):1==t.type&&e.enerymyGenarate(t)})},t.prototype.enerymyGenarate=function(e){var t=cc.instantiate(this.enermy);this.map.node.addChild(t);var o=cc.v2(e.offset.x,e.offset.y),i=this.getTilePosition(o),n=this.mainLayer.getPositionAt(i),a=t.getComponent(r.default);a._tileX=i.x,a._tileY=i.y,a.mainLayer=this.mainLayer,a.brickLayer=this.brickLayer,t.setAnchorPoint(0,0),t.setPosition(n)},t.prototype.playerGenarate=function(e){var t=cc.instantiate(this.player);this.objectLayer.node.addChild(t);var o=cc.v2(e.offset.x,e.offset.y),r=this.getTilePosition(o),n=this.mainLayer.getPositionAt(r),a=t.getComponent(i.default);a._tileX=r.x,a._tileY=r.y,a.mainLayer=this.mainLayer,a.brickLayer=this.brickLayer,a._map=this.map,a.bombPrefab=this.bombPrefab,this.playerComponent=a,t.setAnchorPoint(0,0),n&&t.setPosition(n)},t.prototype.getTilePosition=function(e){this.node.getContentSize();var t=this.map.getTileSize(),o=Math.floor(e.x/t.width),i=Math.floor(e.y/t.height);return cc.v2(o,i)},t.prototype.start=function(){},__decorate([c(cc.TiledMap)],t.prototype,"map",void 0),__decorate([c(cc.Prefab)],t.prototype,"enermy",void 0),__decorate([c(cc.Prefab)],t.prototype,"player",void 0),__decorate([c(cc.Prefab)],t.prototype,"bombPrefab",void 0),__decorate([c(cc.TiledLayer)],t.prototype,"mainLayer",void 0),__decorate([c(cc.TiledObjectGroup)],t.prototype,"objectLayer",void 0),__decorate([c(cc.TiledLayer)],t.prototype,"brickLayer",void 0),t=__decorate([a],t)}(cc.Component);o.default=l,cc._RF.pop()},{"./enermy":"enermy","./player":"player"}],player:[function(e,t,o){"use strict";cc._RF.push(t,"4d73dnuzaJA/YVwreMozprH","player"),Object.defineProperty(o,"__esModule",{value:!0});var i=cc._decorator,r=i.ccclass,n=(i.property,function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._tileX=0,t._tileY=0,t}return __extends(t,e),t.prototype.onLoad=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},t.prototype.onKeyDown=function(e){switch(e.keyCode){case cc.macro.KEY.left:this.goLeft();break;case cc.macro.KEY.right:this.goRight();break;case cc.macro.KEY.up:this.goUp();break;case cc.macro.KEY.down:this.goDown();break;case cc.macro.KEY.space:this.releaseBomb()}},t.prototype.goLeft=function(){this.dir=3,this.movePlay(this._tileX-1,this._tileY)},t.prototype.goRight=function(){this.dir=4,this.movePlay(this._tileX+1,this._tileY)},t.prototype.goUp=function(){this.dir=1,this.movePlay(this._tileX,this._tileY-1)},t.prototype.goDown=function(){this.dir=2,this.movePlay(this._tileX,this._tileY+1)},t.prototype.releaseBomb=function(){if(!this.bomb){var e=cc.instantiate(this.bombPrefab);this.bombTile=cc.v2(this._tileX,this._tileY),e.setAnchorPoint(0,0),this.mainLayer.node.addChild(e);var t=this.mainLayer.getPositionAt(this.bombTile);e.setPosition(t),this.bomb=e}},t.prototype.movePlay=function(e,t){var o=cc.v2(e,t);if(this.mainLayer.getTileGIDAt(o))return!1;if(this.brickLayer.getTileGIDAt(o))return!1;this._tileX=e,this._tileY=t;var i=this.mainLayer.getPositionAt(o);this.node.setPosition(i)},t=__decorate([r],t)}(cc.Component));o.default=n,cc._RF.pop()},{}]},{},["HelloWorld","bomb","enermy","map","player"]);